---
layout: post
title: TeX 的目录结构
categories: LaTeX
description: 对于 $\LaTeX$ 基础用户而言，学习掌握 $\TeX$ 的目录结构并不是必须的。可是，深度使用 $\LaTeX$ 后，你将会发现 $\TeX$ 的目录结构实在是太重要了！
---

对于 $\LaTeX$ 基础用户而言，对于 $\TeX$ 目录结构的了解并不是一件非做不可的事情。可是，随着对 $\LaTeX$ 的深度使用，你会发现掌握 $\TeX$ 的目录结构实在是太重要了！

## TEXMF 树

$\TeX$ 的目录结构 ($\TeX$ Directory Structure, TDS) 是 $\TeX$ 发行版中宏包、字体、帮助文档等文件的组织结构，其又称为 TEXMF 树。在 TEXMF 树下存放的文件都能被 $\TeX$ 系统找到。

在 texlive 中，系统的 TEXMF 树的根目录为 `C:\texlive\xxxx\texmf-dist`（windows 系统，这里的盘符根据你安装时选择的盘符而定）或 `/usr/local/texlive/xxxx/texmf-dist` (mac 系统)。用户的 TEXMF 树的根目录为 `C:\texlive\texmf-local` (windows 系统)或 `/usr/local/texlive/texmf-local` (mac 系统)。

以 mac 操作系统为例，系统的 TEXMF 树下有很多子目录，用于存放不同类型的文件，例如：

+ `tex/latex` 存放 $\LaTeX$ 宏包
+ `doc/latex` 存放 $\LaTeX$ 宏包的帮助文档
+ `source/latex` 存放 $\LaTeX$ 宏包的源代码（一般是 `.dtx` 和 `.ins` 文件）
+ `bibtex` 存放 BIBTEX 工具相关文件，许多宏包配套的 BIBTEX 格式文件位于子目录 `bst` 中
+ `fonts/tfm` 存放 $\TeX$ 使用的字体文件，TFM 格式
+ `fonts/type1` 存放 PostScript 字体文件（Type1），PFB 格式
+ `fonts/opentype` 存放 OpenType 格式的字体文件

## 编写宏包或文档类
我从大三开始接触学习 $\LaTeX$，那时选了一门课叫做数学实验，任课老师张晓平推荐大家学习一下这个排版语言，从此便入了坑。

平时使用 $\LaTeX$ 主要是为了写数学笔记和习题解答，当时我觉得有一件事情比较繁琐，那就是每当我开始写一份新的 `.tex` 文件，我都要重新在导言区写一大堆相似度极高的代码，例如下面的代码举例
```latex
% 调用基本宏包
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
% 提供中文支持
\usepackage{ctex}
\setCJKmainfont[...]{...}
% 定义快捷命令
\newcommand{\e}{\mathrm{e}}
\newcommand{\diff}{\mathop{}\!\mathrm{d}} % 直立微分算子
% （重）定义一些基本的环境
\renewenvironment{proof}{...}{...}
\newenvironment{solve}{...}{...}
% 甚至你可能还需要使用诸如 tcolorbox 此类的宏包来进一步美化你的输出文档
% 以及使用 TikZ 宏包进行封面定制。
\renewcommand{\maketitle}%
  {tikz commands to customize the cover}
```

> 注意，必须先加载 `amsmath` 宏包再加载 `amsthm` 宏包。

尽管我可以直接从前面的 `.tex` 文件中将一些需要的代码复制过来，但我还是觉得太繁琐了。于是，我便开始寻求解决方案，它便是：编写文档类（或者宏包）。

那么如何编写文档类便是头等重要的事情，其实这并不是一件容易的事情，我们需要系统学习文档类编写所需的一套标准化的语言。$\LaTeX$ 项目组为此专门编写了一份教程，在终端中输入
```sh
texdoc clsguide
```
便可以调出该手册。另外这里还有该教程的[中译版](https://github.com/SwitWu/LaTeX-packages-zh-cn/releases/download/1.0/clsguide-zh-cn.pdf)，希望能对你有所帮助。

学习完文档类和宏包编写的一般步骤后，你可以自己试着编写一个文档类（自己命名，但是后缀必须为 `.cls`，且名字不能与已经存在的文档类重复）。然后，将其放到目录 `C:\texlive\texmf-local\tex\latex\local`（windows 系统）或 `/usr/local/texlive/texmf-local/tex/latex/local` (mac 系统) 下，然后在终端中执行：
```sh
sudo texhash
```
或者
```sh
sudo mktexlsr
```
(windows 用户不需要 `sudo`) 来刷新发行版的文件名数据库。这样一来，就只需要在 `.tex` 文件中的导言区写一句
```latex
\documentclass{classname}
```
从此，你便可以更加专注于内容写作。

当然，你也可以为自己的文档类写一份手册（假设命名为 `myclassguide.pdf`），将其放到 `usr/local/texlive/texmf-local/doc` 目录下，一样地需要刷新一下文件名数据库，这样一来，就可以通过 `texdoc myclassguide` 快速调出自己写的手册。

## 参考资料
+ [https://ask.latexstudio.net/ask/question/260.html](https://ask.latexstudio.net/ask/question/260.html)
+ [lshort-zh-cn.pdf](https://mirror-hk.koddos.net/CTAN/info/lshort/chinese/lshort-zh-cn.pdf)
